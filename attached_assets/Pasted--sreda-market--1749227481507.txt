# Промпт для создания страницы "Инсайты" веб-приложения sreda.market

## Контекст проекта
Ты разрабатываешь страницу "Инсайты" для веб-приложения sreda.market - платформы для рынка недвижимости. Страница должна отображать ежедневные аналитические заметки, созданные на основе данных из различных источников.

## Техническое задание

### Основная функциональность
Создай React-компонент страницы "Инсайты" со следующими возможностями:

1. **Отображение аналитических заметок:**
   - Карточки с краткими информационно-аналитическими заметками (до 2000 символов)
   - Встроенные графики и диаграммы (при их наличии)
   - Дата публикации и теги для каждой заметки
   - Превью с возможностью развернуть полный текст

2. **Система фильтрации:**
   - Фильтр по датам (календарь с выбором периода)
   - Фильтр по тегам (множественный выбор)
   - Поиск по ключевым словам
   - Кнопка сброса всех фильтров

3. **Интерфейс и UX:**
   - Адаптивный дизайн для всех устройств
   - Пагинация или бесконечная прокрутка
   - Состояния загрузки и ошибок
   - Плавные анимации переходов

### Техническая архитектура

#### Стек технологий:
- **Frontend:** React с хуками
- **Стилизация:** CSS Modules или Styled Components
- **Управление состоянием:** useState/useEffect или Redux Toolkit
- **API интеграция:** Axios или Fetch API
- **Графики:** Chart.js, D3.js или Recharts

#### Структура данных для заметок:
```typescript
interface InsightNote {
  id: string;
  title: string;
  content: string;
  summary: string; // краткое описание для превью
  publishDate: Date;
  tags: string[];
  charts?: ChartData[]; // данные для графиков
  sources: string[]; // источники данных
  readTime: number; // примерное время чтения
}

interface ChartData {
  type: 'line' | 'bar' | 'pie' | 'area';
  title: string;
  data: any[];
  config: ChartConfig;
}
```

### Дизайн-система и стилизация

#### Следуй текущей дизайн-системе sreda.market:
- Используй установленные цветовые схемы и типографику
- Придерживайся принятых отступов и размеров
- Применяй существующие UI-компоненты (кнопки, инпуты, карточки)
- Обеспечь консистентность с остальными страницами приложения

#### Макет страницы:
```
[Заголовок страницы "Инсайты"]
[Панель фильтров: Даты | Теги | Поиск | Сброс]
[Сетка карточек с заметками]
[Пагинация/Загрузка еще]
```

### Интеграция с API

#### Endpoints для реализации:
```javascript
// Получение списка заметок с фильтрами
GET /api/insights?date_from=YYYY-MM-DD&date_to=YYYY-MM-DD&tags=tag1,tag2&search=keyword&page=1&limit=10

// Получение полной заметки
GET /api/insights/:id

// Получение доступных тегов
GET /api/insights/tags
```

#### Обработка данных от Perplexity API:
- Парсинг аналитических заметок из ответов API
- Извлечение и форматирование данных для графиков
- Обработка ошибок API и fallback-сценарии

### Компоненты для создания

1. **InsightsPage** - основной компонент страницы
2. **FilterPanel** - панель фильтров
3. **InsightCard** - карточка заметки
4. **InsightModal** - модальное окно с полной заметкой
5. **ChartComponent** - компонент для отображения графиков
6. **LoadingState** - состояние загрузки
7. **EmptyState** - пустое состояние при отсутствии данных

### Требования к производительности

- Ленивая загрузка изображений и графиков
- Мемоизация дорогих вычислений
- Дебаунсинг для поиска
- Кэширование API-запросов
- Оптимизация ререндеров компонентов

### Доступность (A11y)

- Семантическая разметка HTML
- ARIA-атрибуты для интерактивных элементов
- Поддержка навигации с клавиатуры
- Контрастность цветов согласно WCAG
- Альтернативные тексты для графиков

## Дополнительные требования

### Мобильная адаптация:
- Адаптивная сетка карточек (1 колонка на мобильных, 2-3 на планшетах, 3-4 на десктопе)
- Оптимизированная панель фильтров для touch-устройств
- Свайп-жесты для навигации между заметками

### SEO-оптимизация:
- Meta-теги для страницы
- Структурированные данные для заметок
- Семантические заголовки H1-H6

### Аналитика:
- Отслеживание просмотров заметок
- Метрики использования фильтров
- Время чтения контента

## Примеры кода для реализации

Создай полнофункциональные компоненты с:
- Современным React-кодом (хуки, функциональные компоненты)
- TypeScript типизацией
- Обработкой ошибок и граничных случаев
- Подробными комментариями к коду
- Готовыми стилями в выбранном подходе

## Дополнительная задача: Страница администратора

### Раздел управления источниками данных

Создай дополнительно страницу администратора с формой для управления каталогом источников данных:

#### Функциональность админ-панели:

1. **Каталог источников:**
   - Таблица всех добавленных источников
   - Статус активности источника (вкл/выкл)
   - Дата последнего обновления данных
   - Частота сбора данных
   - Действия: редактировать, удалить, просмотреть данные

2. **Форма добавления/редактирования источника:**
   - Название источника
   - Описание/комментарий
   - Тип источника (выпадающий список)
   - Настройки в зависимости от типа
   - Теги для категоризации
   - Периодичность сбора (ежечасно, ежедневно, еженедельно)

#### Типы источников и их настройки:

```typescript
interface DataSource {
  id: string;
  name: string;
  description: string;
  type: SourceType;
  config: SourceConfig;
  tags: string[];
  isActive: boolean;
  frequency: 'hourly' | 'daily' | 'weekly';
  lastUpdated: Date;
  createdAt: Date;
}

enum SourceType {
  TELEGRAM_CHANNEL = 'telegram_channel',
  WEBSITE = 'website',
  RSS_FEED = 'rss_feed',
  UPLOADED_FILE = 'uploaded_file',
  SPREADSHEET = 'spreadsheet',
  PDF_DOCUMENT = 'pdf_document'
}

interface SourceConfig {
  // Для Telegram каналов
  channelUrl?: string;
  channelUsername?: string;
  
  // Для веб-сайтов
  websiteUrl?: string;
  cssSelectors?: string[]; // селекторы для парсинга
  
  // Для RSS
  rssUrl?: string;
  
  // Для загруженных файлов
  fileName?: string;
  fileType?: string;
  fileSize?: number;
  uploadedAt?: Date;
  
  // Общие настройки
  keywords?: string[]; // ключевые слова для фильтрации
  excludeKeywords?: string[]; // исключения
}
```

#### Интерфейс формы по типам источников:

1. **Telegram канал:**
   - Поле для URL/username канала
   - Проверка доступности канала
   - Настройка ключевых слов для фильтрации

2. **Веб-сайт:**
   - URL сайта
   - CSS селекторы для парсинга контента
   - Превью парсинга
   - Настройка User-Agent

3. **RSS лента:**
   - URL RSS ленты
   - Валидация RSS
   - Предпросмотр записей

4. **Загрузка файлов:**
   - Drag & drop зона для файлов
   - Поддержка форматов: PDF, XLSX, CSV, TXT, DOCX
   - Прогресс-бар загрузки
   - Превью содержимого файла

#### Компоненты админ-панели:

1. **AdminSourcesPage** - основная страница управления
2. **SourcesTable** - таблица с источниками
3. **SourceForm** - форма добавления/редактирования
4. **FileUploadZone** - компонент загрузки файлов
5. **SourcePreview** - предпросмотр данных источника
6. **SourceTypeSelector** - выбор типа источника
7. **ScheduleSettings** - настройки расписания сбора

#### API endpoints для админ-панели:

```javascript
// Управление источниками
GET /api/admin/sources - получить все источники
POST /api/admin/sources - создать источник
PUT /api/admin/sources/:id - обновить источник
DELETE /api/admin/sources/:id - удалить источник
POST /api/admin/sources/:id/toggle - вкл/выкл источник

// Загрузка файлов
POST /api/admin/sources/upload - загрузка файла
GET /api/admin/sources/:id/preview - предпросмотр данных

// Валидация источников
POST /api/admin/sources/validate - проверка URL/канала
GET /api/admin/sources/:id/test - тест сбора данных
```

#### Дополнительные функции:

1. **Мониторинг источников:**
   - Статистика по каждому источнику
   - Лог ошибок сбора данных
   - Алерты при недоступности источника

2. **Batch операции:**
   - Массовое включение/отключение источников
   - Массовое добавление тегов
   - Экспорт/импорт конфигурации источников

3. **Безопасность:**
   - Проверка прав доступа администратора
   - Валидация загружаемых файлов
   - Защита от вредоносного контента

#### Макет админ-страницы:
```
[Заголовок "Управление источниками данных"]
[Кнопка "Добавить источник" | Фильтры | Поиск]
[Таблица источников с действиями]
[Модальное окно формы источника]
[Статистика и мониторинг]
```

#### Валидация и обработка ошибок:

- Валидация URL-адресов в реальном времени
- Проверка доступности Telegram каналов
- Валидация загружаемых файлов (размер, формат, безопасность)
- Обработка ошибок сети и API
- Информативные сообщения об ошибках для пользователя

## Результат

Предоставь:
1. Полный код всех компонентов страницы "Инсайты"
2. Полный код админ-панели управления источниками
3. Файлы стилей для обеих частей
4. Типы TypeScript
5. Примеры API-вызовов
6. Схему базы данных для источников
7. Инструкции по интеграции в существующее приложение

Код должен быть готов к production-использованию с учетом всех требований выше, включая безопасность и масштабируемость.