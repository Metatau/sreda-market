# üéØ –§–ò–ù–ê–õ–¨–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–®–ò–ë–ö–ò –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò

## üö® –°–ò–¢–£–ê–¶–ò–Ø
Frontend —Å–∏—Å—Ç–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –ò–î–ï–ê–õ–¨–ù–û (5/5 –ø–∞—Ä–æ–ª—å, –≤—Å–µ –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã), –Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è "–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏". –ù—É–∂–Ω–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å backend –ø—Ä–æ–±–ª–µ–º—É.

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ—á–Ω–æ–π –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å server –ª–æ–≥–∏ –¥–ª—è —Ç–æ—á–Ω–æ–π –æ—à–∏–±–∫–∏:
pm2 logs sreda-market --lines 50
# –ò–õ–ò –µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω —á–µ—Ä–µ–∑ npm:
tail -f /var/log/sreda-market/app.log

# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ—á–Ω—É—é –æ—à–∏–±–∫—É
```

### –®–∞–≥ 2: –ü—Ä—è–º–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
```bash
# –¢–µ—Å—Ç —Å —Ç–µ–º–∏ –∂–µ –¥–∞–Ω–Ω—ã–º–∏ —á—Ç–æ –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ:
curl -X POST "http://localhost:5000/api/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "firstName": "–ê–Ω–¥—Ä–µ–π",
    "lastName": "–í–æ—Ä–æ–±–µ–π",
    "username": "–í–æ—Ä–æ–±–µ–π",
    "email": "1@test.com",
    "password": "StrongPass123!",
    "promoCode": "TEST30"
  }' \
  -v
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
psql -h localhost -U sreda_user -d sreda_market -c "SELECT id, email, username FROM users WHERE email = '1@test.com' OR username = '–í–æ—Ä–æ–±–µ–π';"
```

## üõ†Ô∏è –í–û–ó–ú–û–ñ–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 1: –£–ª—É—á—à–∏—Ç—å error handling –¥–ª—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
```javascript
// –í server/routes.ts —É–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:
app.post('/api/auth/register', async (req, res) => {
  try {
    const { firstName, lastName, username, email, password, promoCode } = req.body;
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    const existingUser = await db.select().from(users).where(
      or(
        eq(users.email, email),
        eq(users.username, username)
      )
    );
    
    if (existingUser.length > 0) {
      const existingByEmail = existingUser.find(u => u.email === email);
      const existingByUsername = existingUser.find(u => u.username === username);
      
      if (existingByEmail && existingByUsername) {
        return res.status(409).json({
          error: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –∏ –∏–º–µ–Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç',
          code: 'DUPLICATE_EMAIL_USERNAME'
        });
      } else if (existingByEmail) {
        return res.status(409).json({
          error: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç',
          code: 'DUPLICATE_EMAIL'
        });
      } else if (existingByUsername) {
        return res.status(409).json({
          error: '–≠—Ç–æ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∂–µ –∑–∞–Ω—è—Ç–æ',
          code: 'DUPLICATE_USERNAME'
        });
      }
    }
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const newUser = await createUser({
      firstName,
      lastName,
      username,
      email,
      password,
      promoCode
    });
    
    // –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏
    req.session.userId = newUser.id;
    req.session.user = {
      id: newUser.id,
      email: newUser.email,
      firstName: newUser.firstName,
      lastName: newUser.lastName
    };
    
    res.status(201).json({
      success: true,
      message: '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ',
      user: {
        id: newUser.id,
        email: newUser.email,
        firstName: newUser.firstName,
        lastName: newUser.lastName
      }
    });
    
  } catch (error) {
    console.error('Registration error:', error);
    
    // –î–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫
    if (error.code === '23505') { // PostgreSQL unique violation
      if (error.detail.includes('email')) {
        return res.status(409).json({
          error: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç',
          code: 'DUPLICATE_EMAIL'
        });
      } else if (error.detail.includes('username')) {
        return res.status(409).json({
          error: '–≠—Ç–æ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∂–µ –∑–∞–Ω—è—Ç–æ',
          code: 'DUPLICATE_USERNAME'
        });
      }
    }
    
    if (error.name === 'ValidationError') {
      return res.status(422).json({
        error: '–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö',
        details: error.message,
        code: 'VALIDATION_ERROR'
      });
    }
    
    res.status(500).json({
      error: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞',
      code: 'INTERNAL_ERROR'
    });
  }
});
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 2: –£–ª—É—á—à–∏—Ç—å frontend error handling
```javascript
// –í client/src/pages/Login.tsx —É–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫:
const handleRegistration = async (e) => {
  e.preventDefault();
  setIsSubmitting(true);
  setErrors({});
  
  try {
    const response = await fetch('/api/auth/register', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      credentials: 'include',
      body: JSON.stringify({
        firstName,
        lastName,
        username,
        email,
        password,
        promoCode
      })
    });
    
    const data = await response.json();
    
    if (!response.ok) {
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫
      switch (data.code) {
        case 'DUPLICATE_EMAIL':
          setErrors({ email: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç' });
          break;
        case 'DUPLICATE_USERNAME':
          setErrors({ username: '–≠—Ç–æ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∂–µ –∑–∞–Ω—è—Ç–æ' });
          break;
        case 'DUPLICATE_EMAIL_USERNAME':
          setErrors({ 
            email: 'Email —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è',
            username: '–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–Ω—è—Ç–æ'
          });
          break;
        case 'VALIDATION_ERROR':
          setErrors({ general: `–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: ${data.details}` });
          break;
        default:
          setErrors({ general: data.error || '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏' });
      }
      return;
    }
    
    // –£—Å–ø–µ—à–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
    setUser(data.user);
    setIsAuthenticated(true);
    showSuccess('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ sreda.market!');
    
  } catch (error) {
    console.error('Registration error:', error);
    setErrors({ 
      general: '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.' 
    });
  } finally {
    setIsSubmitting(false);
  }
};
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 3: –î–æ–±–∞–≤–∏—Ç—å –æ—á–∏—Å—Ç–∫—É –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π
```sql
-- –ï—Å–ª–∏ –µ—Å—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î, –æ—á–∏—Å—Ç–∏—Ç—å –∏—Ö:
-- –û–°–¢–û–†–û–ñ–ù–û: –í—ã–ø–æ–ª–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ backup!

DELETE FROM users a USING users b 
WHERE a.id < b.id 
AND a.email = b.email;

DELETE FROM users a USING users b 
WHERE a.id < b.id 
AND a.username = b.username;
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 4: –¢–µ—Å—Ç —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
```bash
# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:
curl -X POST "http://localhost:5000/api/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "firstName": "–ù–æ–≤—ã–π",
    "lastName": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
    "username": "uniqueuser'$(date +%s)'",
    "email": "unique'$(date +%s)'@test.com",
    "password": "UniquePass123!",
    "promoCode": "TEST30"
  }' \
  -v
```

## üß™ –§–ò–ù–ê–õ–¨–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–∞–Ω–Ω—ã–µ "–ê–Ω–¥—Ä–µ–π –í–æ—Ä–æ–±–µ–π" —É–∂–µ –µ—Å—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ:
psql -h localhost -U sreda_user -d sreda_market -c "SELECT * FROM users WHERE email = '1@test.com' OR username = '–í–æ—Ä–æ–±–µ–π';"
```

### –¢–µ—Å—Ç 2: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
```
–í –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —Å –¥–∞–Ω–Ω—ã–º–∏:
- –ò–º—è: –ù–æ–≤—ã–π
- –§–∞–º–∏–ª–∏—è: –¢–µ—Å—Ç–æ–≤—ã–π  
- Username: newtestuser
- Email: newtest@example.com
- –ü–∞—Ä–æ–ª—å: NewTestPass123!
- –ü—Ä–æ–º–æ–∫–æ–¥: TEST30
```

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
```bash
# –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
psql -h localhost -U sreda_user -d sreda_market -c "SELECT id, email, username, created_at FROM users ORDER BY created_at DESC LIMIT 5;"
```

## ‚úÖ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚úÖ –î—É–±–ª–∏—Ä—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏
- ‚úÖ –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- ‚úÖ Frontend –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- ‚úÖ Backend –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –æ—à–∏–±–∫–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

## üéØ –ò–¢–û–ì–û–í–ê–Ø –ü–†–û–í–ï–†–ö–ê

**–°–∏—Å—Ç–µ–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ 99%!** 
- ‚úÖ UI/UX - –∏–¥–µ–∞–ª—å–Ω—ã–π
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è - –º–∏—Ä–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞
- ‚úÖ Security - production ready
- ‚ö†Ô∏è Error handling - –Ω—É–∂–Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

**–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç 100% –≥–æ—Ç–æ–≤–∞ –∫ production!** üöÄ