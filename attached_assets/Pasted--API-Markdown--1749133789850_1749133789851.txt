Конечно, вот описание API на основе предоставленных источников, преобразованное в формат Markdown:

```markdown
# Описание API для доступа к базе объявлений ADS-API.RU

## Введение

Данное API позволяет получать объявления из базы данных, собранной парсером ADS-API.RU. База содержит объявления с различных сайтов, включая avito.ru, realty.yandex.ru, cian.ru, sob.ru, youla.ru, moyareklama.ru, и domclick.ru.

Вы можете подключиться к API или оплатить доступ на странице Подключение к API.

Существуют сторонние разработки партнеров, использующие данное API. Например, платный модуль "Универсальный импорт" от веб-студии Акрит доступен для интеграции API с CMS Битрикс и импорта объявлений на сайт на Битриксе.

## Общие ограничения и особенности

*   При любом типе доступа (кроме специально оговоренных для тарифа) между запросами к API для одного пользователя должна быть **пауза минимум 5 секунд**. Запросы, отправленные чаще, не будут обрабатываться, и в ответ будет возвращено сообщение об ошибке. Код ответа при превышении лимита частоты запросов — **429**.
*   Система не собирает абсолютно все объявления со всех площадок; возможны пропуски. Однако, количество пропусков считается незначительным относительно общего числа собираемых объявлений, особенно в категории Недвижимость.
*   Собираются не все категории; набор категорий варьируется для разных источников. Наличие объявлений для определенной категории и источника можно проверить в разделе "Объявления" на сайте после входа, поскольку API использует ту же базу данных.
*   Если значения параметров запроса содержат пробелы или другие спецсимволы, их **обязательно следует кодировать**, используя функции типа `urlencode` в PHP или аналогичные в других языках/библиотеках.

## Тестовый доступ

Для тестового доступа действуют следующие ограничения:

*   Выдается **один раз на 14 дней**.
*   Часть номера телефона (поле `phone`) скрывается символами XXXXX.
*   Значение поля `price` **всегда равно 0**. Это ограничение было подтверждено 8 января 2024 года.
*   За один запрос можно получить **не более 50 объявлений**.
*   Параметр запроса `phone` (фильтрация по конкретному номеру телефона) **запрещен**.

## Коды ответов

Ответы API содержат числовое поле `code`, указывающее статус запроса. Возможные значения и их расшифровка:

*   **200**: Успешно. Запрос выполнен корректно.
*   **400**: Ошибка запроса. Может означать, что не задан обязательный параметр ИЛИ в запросе переданы неизвестные параметры. Имена неизвестных параметров возвращаются в массиве `params_with_error`. Например, передача `category_ids` вместо `category_id` приведет к такой ошибке.
*   **401**: Неверные `user` или `token`.
*   **402**: Срок действия `token` истек, требуется оплата доступа.
*   **403**: Учетная запись пользователя заблокирована.
*   **404**: Объявление не найдено.
*   **429**: Превышен лимит частоты запросов (чаще одного запроса в 5 секунд).
*   **452**: Доступ разрешен только из программы партнера.
*   **453**: Доступ разрешен только к категории "Недвижимость" и подкатегориям.
*   **454**: Доступ разрешен только к определенному городу.
*   **455**: Метод API доступен только для платного тарифа.

Примеры ответа с кодом ошибки в формате JSON:

```json
{
  "code": 401,
  "error": "Неверный user или token"
}
```
```json
{
  "code": 400,
  "error": "В запросе передан один или несколько несуществующих параметров",
  "params_with_error": ["category_ids"]
}
```

## Методы API

В документации описаны следующие методы API:

*   `/main/api`: Получение набора объявлений.
*   `/main/apigetone`: Получение данных об одном объявлении по id.
*   `/main/apigetparams`: Получение данных о дополнительных параметрах по id категории.
*   `/main/apigetcheckfeed`: Получение фида результатов проверки объявлений на актуальность.
*   `/main/api-add-link-to-parse-queue`: Добавление одного объявления в очередь на парсинг по ссылке. Этот метод был добавлен 6 февраля 2024 года.

## Детальное описание методов

### Получение набора объявлений (`/main/api`)

Запросы к этому методу выполняются на адрес `https://ads-api.ru/main/api` методом GET. За один запрос можно получить не более 1000 объявлений (для платного доступа) или 50 (для тестового доступа).

**Возможные параметры запроса**:

*   `user`: **Обязательный**. Логин пользователя в системе (email).
*   `token`: **Обязательный**. Access token для авторизации.
*   `category_id`: Необязательный. ID категории. Можно указать несколько через запятую (например: `category_id=2,3`). Список ID категорий приведен ниже.
*   `q`: Необязательный. Текст для поиска по заголовку (`title`).
*   `price1`: Необязательный. Нижняя граница цены.
*   `price2`: Необязательный. Верхняя граница цены.
*   `date1`: Необязательный. Дата от (например: "2014-11-02" или "2014-11-02 17:10:00"). Время московское минус 30 минут.
*   `date2`: Необязательный. Дата до (например: "2014-11-02" или "2014-11-02 17:10:00"). Время московское минус 30 минут.
*   `person_type`: Необязательный. Тип автора объявления. 1 - Частное лицо (как на источнике), 2 - Агентство, 3 - Собственник (определяется по количеству объявлений с одним телефоном за последний месяц, если <5). Значение 1 включает 3. Можно указать только одно значение. Для получения всех объявлений, параметр не используется или остается пустым. **Важное изменение с конца февраля 2024:** если используется `person_type=3` вместе с `withphone=0`, рекомендуется использовать только `person_type=1`.
*   `city`: Необязательный. Название города, области или региона. Поддерживаются логические операторы (AND, OR, NOT, AND NOT, скобки) и множественные значения через `|` (например: `city=Москва|Тула`). Список названий регионов приведен ниже.
*   `metro`: Необязательный. Название станции метро или района города. Если в городе есть метро, следует указывать метро.
*   `nedvigimost_type`: Необязательный. ID типа недвижимости для категории "Недвижимость". Можно указать несколько через запятую (например: `nedvigimost_type=1,2`). Список ID типов недвижимости приведен ниже.
*   `phone`: Необязательный. Телефон в формате 8xxxYYYYYYY для фильтрации. **Запрещен при тестовом доступе**.
*   `source`: Необязательный. ID сайта-источника. Множественные значения через запятую (`source=1,7`). Доступные ID:
    *   1 - avito.ru
    *   3 - realty.yandex.ru
    *   4 - cian.ru
    *   5 - sob.ru
    *   6 - youla.io
    *   7 - n1.ru (нет новых объявлений)
    *   10 - moyareklama.ru
    *   11 - domclick.ru
*   `param[xxx]`: Необязательный. Дополнительные параметры, где `xxx` - код параметра. Можно использовать несколько. Коды и значения можно узнать в разделе "Объявления" на сайте или в разделе "Дополнительные параметры всех категорий" в документации. Дополнительные параметры доступны при выборе категории второго уровня.
*   `format`: Необязательный. Формат ответа: `json` или `xml`. По умолчанию `json`.
*   `phone_operator`: Необязательный. Оператор сотовой связи. Список значений приведен ниже.
*   `limit`: Необязательный. Ограничивает количество объявлений. Максимум 1000 (платный) или 50 (тестовый).
*   `startid`: Необязательный. Возвращает объявления с `id` больше или равным заданному. Отсортированы по `id` по возрастанию. Игнорирует `date1`, `date2`. Полезен для получения новых объявлений, задав `id` последнего + 1.
*   `withcoords`: Необязательный. Если `1`, возвращает только объявления с координатами (`lat`, `lng`) отличными от 0.
*   `sort`: Необязательный. Сортировка по полю `time`. `asc` (по возрастанию) или `desc` (по убыванию). По умолчанию `desc`.
*   `withphone`: Необязательный. Если `0`, включает в выдачу объявления без телефонов (например, с Юлы). Без этого параметра выдаются только объявления с телефонами. **Важное изменение с конца февраля 2024:** для получения большинства объявлений от частников из раздела Недвижимость с авито, идущих без телефонов, необходимо добавить `withphone=0`.
*   `phone_protected`: Необязательный. Фильтрация по полю `phone_protected`. 1 - только с защищенным/подменным, 0 - только с незащищенным. Актуально для cian и realty.yandex.ru. На avito все номера защищены (поле=1). Для других источников поле `null`. Номера соответствуют указанным на источнике при парсинге.
*   `avitoid`: Необязательный. Фильтрация по ID на источнике. Выводит все версии объявления с таким ID. Рекомендуется использовать вместе с `source`.
*   `area`: Необязательный. Фильтрация по координатам в заданном выпуклом многоугольнике. Задается координатами вершин (`area[n][lat]`, `area[n][lng]`). Минимум 4 вершины. Описание параметра добавлено 27 января 2024 года, хотя сам параметр существовал ранее. Параметры можно получить, нарисовав область на карте в разделе "Объявления" на сайте.
*   `is_actual`: Необязательный. Фильтрация по полю `is_actual` объявления. Параметр добавлен 1 февраля 2024 года. Возможные значения:
    *   11 - актуально (на основе факта парсинга или поднятия на источнике).
    *   1 - актуально (на основе проверки на актуальность).
    *   0 - неактуально (на основе проверки на актуальность).
    Можно указать несколько значений через запятую (например: `is_actual=11,1`).

**Описание ответа на запрос**:

Ответ включает поле `data`, которое является массивом объектов. Каждый объект в массиве представляет одно объявление и содержит следующие поля:

*   `id`: ID объявления в системе ADS-API.RU.
*   `url`: URL объявления на сайте-источнике.
*   `title`: Заголовок объявления.
*   `price`: Цена. **При тестовом доступе всегда 0**.
*   `time`: Дата и время добавления или обновления объявления в системе. Время московское минус 30 минут.
*   `phone`: Телефон. Формат: 11 цифр (первая 8), все 0 (если нет), или последние заменены на XXXXX (тестовый доступ). Телефон берется таким, каким он был на источнике в момент парсинга.
*   `phone_operator`: Название мобильного оператора.
*   `person`: Персона для контактов. Для частных лиц обычно "недоступно".
*   `contactname`: Контактное лицо. Указывается, если `person` - название компании.
*   `person_type`: Тип персоны: "Частное лицо", "Агентство", "Частное лицо (фильтр)".
*   `person_type_id`: ID типа персоны: 1, 2, или 3.
*   `city`: Регион и Город вместе.
*   `metro`: Станция метро или район. Если метро есть, указывается станция.
*   `address`: Адрес (улица, дом).
*   `description`: Описание объявления.
*   `nedvigimost_type`: Тип недвижимости: "Продам", "Сдам", "Куплю", "Сниму".
*   `nedvigimost_type_id`: ID типа недвижимости: 1, 2, 3, или 4.
*   `avitoid`: ID объявления на сайте-источнике.
*   `source`: Название сайта-источника.
*   `source_id`: ID сайта-источника в системе.
*   `images`: Массив объектов, каждый с полем `imgurl` (ссылка на фото на источнике). Сами фото не предоставляются, только ссылки.
*   `params`: Ассоциативный массив дополнительных параметров (`param_xxx`). Ключи - названия параметров.
*   `cat1_id`: ID категории первого уровня (например, 1 для "Недвижимость").
*   `cat2_id`: ID категории второго уровня (например, 2 для "Квартиры").
*   `cat1`: Название категории первого уровня.
*   `cat2`: Название категории второго уровня.
*   `coords`: Объект с полями `lat` и `lng` для координат.
*   `region`: Только название региона.
*   `city1`: Только название города.
*   `param_xxx`: Дополнительный параметр с кодом `xxx`.
*   `count_ads_same_phone`: Количество объявлений с тем же номером. Актуально только для категории Недвижимость и подкатегорий, для других - `null`.
*   `phone_protected`: Признак защищенности телефона. 1 - защищен, 0 - не защищен, `null` - параметр недоступен. 2 - защищен номером от Циан. Актуально для avito, realty.yandex.ru, cian.
*   `phone_region`: Регион мобильного телефона.
*   `km_do_metro`: Расстояние до ближайшего метро в километрах. 0, если неизвестно.
*   `params2`: Ассоциативный массив с атрибутами объявления, отформатированными как на источнике. Актуально для Недвижимости и Авто с avito.
*   `price_metric`: Единица измерения цены (например, "₽" или "₽ в месяц"). Актуально для avito и cian.
*   `time_source_created`: **NEW**. Дата и время создания объявления на источнике. Время московское. Доступно для avito, realty.yandex.ru, cian, domclick.
*   `time_source_updated`: **NEW**. Дата и время обновления объявления на источнике. Время московское. Доступно для avito, realty.yandex.ru, cian, domclick.
*   `is_actual`: **NEW**. Признак актуальности объявления. Значения: 11 (актуально на основе парсинга/поднятия), 1 (актуально на основе проверки), 0 (неактуально на основе проверки). Значение одинаково для всех версий одного объявления. Добавлено 1 февраля 2024 года.
*   `metro_only`: **NEW**. Только станция метро, если есть, иначе пустая строка. Добавлено недавно.
*   `district_only`: **NEW**. Только район города, если есть, иначе пустая строка. Добавлено недавно.

Примеры ответов (JSON и XML) доступны в источниках.

**Пагинация и получение более 1000 объявлений**

Если необходимо получить большое количество объявлений (более 1000 за один запрос) или реализовать пагинацию, рекомендуется использовать **фильтрацию по временному интервалу** с параметрами `date1` и `date2`. Запрашивайте объявления небольшими порциями, например, за 5 минут или минуту. Обязательно делайте задержку между запросами.

Если при запросе за интервал [A, B) получено ровно 1000 объявлений (максимальное количество), это означает, что в этом интервале есть еще объявления. Чтобы получить их, определите дату самого раннего объявления в полученной выборке (если `sort=desc`). Пусть эта дата будет C. Следующий запрос следует выполнить с новым временным интервалом [A, C). Продолжайте сокращать интервал таким образом, пока не получите ответ, содержащий менее 1000 объявлений. При использовании сортировки `sort=asc` принцип аналогичен.

### Получение данных об одном объявлении по id (`/main/apigetone`)

Запросы выполняются на адрес `https://ads-api.ru/main/apigetone` методом GET.

**Возможные параметры запроса**:

*   `user`: **Обязательный**. Логин пользователя (email).
*   `token`: **Обязательный**. Access token.
*   `id`: **Обязательный**. ID объявления в системе ADS-API.RU.
*   `format`: Необязательный. json или xml. По умолчанию json.

Пример запроса:
```
https://ads-api.ru/main/apigetone?user=user@localhost.net&token=12345&id=123
```

### Получение данных о дополнительных параметрах по id категории (`/main/apigetparams`)

Запросы выполняются на адрес `https://ads-api.ru/main/apigetparams` методом GET. Этот метод позволяет получить иерархию возможных дополнительных параметров для указанной категории. Текстовое перечисление всех параметров также доступно в разделе "Дополнительные параметры всех категорий" документации.

**Возможные параметры запроса**:

*   `user`: **Обязательный**. Логин пользователя (email).
*   `token`: **Обязательный**. Access token.
*   `category_id`: **Обязательный**. ID категории.
*   `format`: Необязательный. json или xml. По умолчанию json.

Пример запроса:
```
https://ads-api.ru/main/apigetparams?user=user@localhost.net&token=12345&category_id=2
```

### Получение фида результатов проверки объявлений на актуальность (`/main/apigetcheckfeed`)

Объявление считается актуальным, если оно активно и не снято с публикации на источнике. Проверка на актуальность проводится для объявлений из раздела Недвижимость от Частных лиц примерно через 4 дня и через 1 месяц (время может немного варьироваться) после их попадания в систему. Это ограничение по категории и типу автора применено для снижения нагрузки на систему и источники.

Результаты проверок формируют фид (ленту). В фиде содержатся данные обо всех проверках, как актуальных, так и неактуальных. Объявления в фиде отсортированы по дате проверки (`time`) по убыванию. Отсутствие объявления в фиде означает, что проверка не проводилась.

Пользователи могут периодически запрашивать этот фид. Используя `avitoid` и `source_id` из фида, можно искать соответствующие объявления в своей собственной системе и помечать их актуальность согласно полю `is_actual`. Также можно обновить дату проверки (`time`). Фид можно загружать полностью, подобно ленте новых объявлений, или запрашивать результаты проверок конкретных объявлений по их `id` или `avitoid` (с указанием `source_id`).

Также стоит отметить, что фильтрация объявлений по актуальности (`is_actual`) доступна непосредственно в методе `/main/api`.

Запросы к фиду выполняются на адрес `https://ads-api.ru/main/apigetcheckfeed` методом GET. За один запрос возвращается не более 1000 результатов проверки (1000 для платного доступа, 50 для тестового).

**Возможные параметры запроса**:

*   `user`: **Обязательный**. Логин пользователя (email).
*   `token`: **Обязательный**. Access token.
*   `is_actual`: Необязательный. Фильтрация ленты по актуальности. 0 - неактуальные, 1 - актуальные.
*   `date1`: Необязательный. Дата проверки от (например: "2014-11-02" или "2014-11-02 17:10:00"). Время московское.
*   `date2`: Необязательный. Дата проверки до (например: "2014-11-02" или "2014-11-02 17:10:00"). Время московское.
*   `avitoid`: Необязательный. ID на источнике для получения результатов проверки. Требует указания `source_id`. Можно указать несколько ID через запятую.
*   `id`: Необязательный. ID в системе ADS-API.RU для получения результатов проверки. Можно указать несколько ID через запятую.
*   `source_id`: Необязательный. ID сайта-источника для фильтрации. Доступные ID источников для проверки актуальности:
    *   1 - avito.ru
    *   3 - realty.yandex.ru
    *   4 - cian.ru
    *   5 - sob.ru
    *   6 - youla.io
    *   10 - moyareklama.ru
    *   **Объявления с domclick.ru (ID 11) не проверяются на актуальность**.
    Можно указать несколько ID через запятую.
*   `limit`: Необязательный. Ограничение количества результатов.
*   `sort`: Необязательный. Сортировка по полю `time` (`asc` или `desc`). По умолчанию `desc`.
*   `format`: Необязательный. json или xml. По умолчанию json.

Примеры запросов:
```
https://ads-api.ru/main/apigetcheckfeed?user=user@localhost.net&token=12345
https://ads-api.ru/main/apigetcheckfeed?user=user@localhost.net&token=12345&date1=2020-08-01+17:00:00&date2=2020-08-01+18:00:00
https://ads-api.ru/main/apigetcheckfeed?user=user@localhost.net&token=12345&is_actual=0&source_id=1
https://ads-api.ru/main/apigetcheckfeed?user=user@localhost.net&token=12345&format=xml&limit=100
```

**Описание ответа на запрос**:

Ответ включает поле `data`, которое является массивом объектов. Каждый объект в массиве содержит результаты проверки одного объявления с полями:

*   `id`: ID объявления в системе ADS-API.RU.
*   `avitoid`: ID объявления на сайте-источнике.
*   `source_id`: ID сайта-источника.
*   `is_actual`: Актуальность: 0 - снято/неактуально, 1 - актуально.
*   `time`: Дата и время проверки. Время московское.
*   `url`: URL объявления на сайте-источнике.

### Добавление одного объявления в очередь на парсинг по ссылке (`/main/api-add-link-to-parse-queue`)

Этот метод **доступен только для платных тарифов** и недоступен при тестовом доступе. Метод позволяет добавить объявление в очередь на парсинг, предоставив прямую ссылку (URL) на карточку объявления. Поддерживаются источники: avito (только категория "Недвижимость"), cian и yandex (недвижимость).

**Точное время**, когда объявление будет спарсено, **не регламентируется** и зависит от загруженности очереди. Если объявление с таким же ID на источнике уже есть в базе ADS-API.RU за последние 31 день, оно **не будет добавлено** в очередь и не будет повторно спарсено. В случае успешного парсинга, объявление появится в базе и его можно будет получить через метод `/main/api` (используя avitoid и source, или в общей ленте).

Запросы выполняются на адрес `https://ads-api.ru/main/api-add-link-to-parse-queue` методом GET.

**Возможные параметры запроса**:

*   `user`: **Обязательный**. Логин пользователя (email).
*   `token`: **Обязательный**. Access token.
*   `url`: **Обязательный**. Ссылка (URL) на карточку объявления на сайте-источнике. Можно передать только одну ссылку за запрос. Значение параметра **должно быть закодировано** (например, функцией `urlencode` в PHP).
*   `format`: Необязательный. json или xml. По умолчанию json.

**Описание ответа на запрос**:

Ответ включает поле `added`, которое является массивом.

*   `added`: Массив, содержащий идентификатор объявления на источнике (`avitoid`), которое было успешно передано в очередь на парсинг. Если массив пустой (`[]`), это означает, что объявление уже есть в базе за последние 31 день и не было добавлено в очередь.

Примеры ответа (JSON):
```json
{
  "code": 200,
  "added": ["4061265159714724680"],
  "status": "ok"
}
```
```json
{
  "code": 200,
  "added": [],
  "status": "ok"
}
```

## Значения некоторых параметров запроса

Ниже приведены списки возможных значений для некоторых параметров запроса метода `/main/api`.

**Значения параметра `category_id`**:
(Жирным шрифтом выделены категории 1-го уровня, нежирным - 2-го)

*   1 **Недвижимость**
    *   2 Квартиры
    *   3 Комнаты
    *   4 Дома, дачи, коттеджи
    *   5 Земельные участки
    *   6 Гаражи и машиноместа
    *   7 Коммерческая недвижимость
    *   8 Недвижимость за рубежом
*   12 **Услуги**
    *   13 Предложения услуг
*   21 **Транспорт**
    *   22 Автомобили

**Значения параметра `nedvigimost_type`**:

*   1 Продам
*   2 Сдам
*   3 Куплю
*   4 Сниму

**Значения параметра `phone_operator`**:

*   !Билайн
*   !МТС
*   !Мегафон
*   !РТ
*   !СМАРТС
*   !Теле2
*   ... (и другие, полный список в источнике)

**Названия регионов, используемые в системе**:

Эти названия используются в параметре `city`. Города федерального значения (Москва, Санкт-Петербург, Севастополь) указываются как отдельные регионы.

*   Москва
*   Санкт-Петербург
*   Севастополь
*   Адыгея
*   Алтай
*   Алтайский край
*   ... (полный список в источнике)

## Дополнительные параметры всех категорий

Данные о дополнительных параметрах для заданной категории также можно получить с помощью метода `/main/apigetparams`. Новая версия документа (от февраля 2024 года) обновила форматирование и добавила описания для запроса диапазонов, но сами параметры не изменились. Указаны параметры только для подкатегорий "Недвижимости" и "Автомобили". Значения типа "Строка" указываются в кавычках в документации, но **при передаче в запросе кавычки не используются**.

Пример описания дополнительных параметров. Формат: `Параметр в запросе [param[xxx]]` - `Поле в ответе [param_xxx]`:

*   **category_id=2, Квартиры**
    *   `param Тип объявления` - `param_1943 Тип объявления`. Значения: "Продам", "Сдам", "Куплю", "Сниму".
        *   Если Тип объявления = "Продам":
            *   `param Количество комнат` - `param_1945 Количество комнат`. Значения: "Студия", [любое целое число].
            *   `param Вид объекта` - `param_1957 Вид объекта`. Значения: "Вторичка", "Новостройка".
            *   `param Срок сдачи` - `param_12867 Срок сдачи`.
            *   `param Площадь, от`. Значения: [любое целое число], "> 200".
            *   `param Площадь, до`. Значения: [любое целое число], "> 200".
            *   ... (и другие параметры, см. источник)
        *   Если Тип объявления = "Сдам":
            *   `param Срок аренды` - `param_2016 Срок аренды`. Значения: "На длительный срок", "Посуточно".
            *   `param Комиссия` - `param_6862 Комиссия`. Значения: "Нет", "Есть".
            *   `param Залог` - `param_6866 Залог`. Значения: "Без залога", "0,5 месяца", [любое целое число].
            *   `param Количество комнат` - `param_2019 Количество комнат`. Значения: "Студия", [любое целое число].
            *   ... (и другие параметры, см. источник)
        *   Если Тип объявления = "Куплю":
            *   `param Количество комнат` - `param_2085 Количество комнат`. Значения: "Студия", [любое целое число].
        *   Если Тип объявления = "Сниму":
            *   `param Срок аренды` - `param_2098 Срок аренды`. Значения: "На длительный срок", "Посуточно".
            *   `param Количество комнат` - `param_2101 Количество комнат`. Значения: "Студия", [любое целое число].

*   **category_id=3, Комнаты**
    *   `param Тип объявления` - `param_2517 Тип объявления`. Значения: "Продам", "Сдам", "Куплю", "Сниму".
        *   Если Тип объявления = "Продам":
            *   `param Площадь комнаты, от`. Значения: [любое целое число], "> 50".
            *   `param Площадь комнаты, до`. Значения: [любое целое число], "> 50".
            *   ... (и другие параметры, см. источник)
        *   ... (параметры для "Сдам", "Куплю", "Сниму", см. источник)

*   **category_id=4, Дома, дачи, коттеджи**
    *   `param Тип объявления` - `param_3040 Тип объявления`. Значения: "Продам", "Сдам", "Куплю", "Сниму".
        *   Если Тип объявления = "Продам":
            *   `param Вид объекта` - `param_3042 Вид объекта`. Значения: "Дом", "Дача", "Коттедж", "Таунхаус".
            *   `param Площадь дома, от`. Значения: [любое целое число], "> 1000".
            *   ... (и другие параметры, см. источник)
        *   ... (параметры для "Сдам", "Куплю", "Сниму", см. источник)

*   **category_id=5, Земельные участки**
    *   `param Тип объявления` - `param_4195 Тип объявления`. Значения: "Продам", "Сдам", "Куплю", "Сниму".
        *   Если Тип объявления = "Продам":
            *   `param Категория земель` - `param_4313 Категория земель`. Значения: "Поселений (ИЖС)", "Сельхозназначения (СНТ, ДНП)", "Промназначения".
            *   `param Площадь, от`. Значения: [любое целое число].
            *   ... (и другие параметры, см. источник)
        *   ... (параметры для "Сдам", "Куплю", "Сниму", см. источник)

*   **category_id=6, Гаражи и машиноместа**
    *   `param Тип объявления` - `param_4780 Тип объявления`. Значения: "Продам", "Сдам", "Куплю", "Сниму".
        *   Если Тип объявления = "Продам":
            *   `param Вид объекта` - `param_4782 Вид объекта`. Значение: "Гараж".
            *   `param Тип гаража` - `param_4784 Тип гаража`. Значения: "Железобетонный", "Кирпичный", "Металлический", "Машиноместо".
            *   `param Тип машиноместа` - `param_4789 Тип машиноместа`. Значения: "Многоуровневый паркинг", "Подземный паркинг", "Крытая стоянка", "Открытая стоянка".
            *   ... (и другие параметры, см. источник)
        *   ... (параметры для "Сдам", "Куплю", "Сниму", см. источник)

*   **category_id=7, Коммерческая недвижимость**
    *   `param Тип объявления` - `param_4867 Тип объявления`. Значения: "Продам", "Сдам", "Куплю", "Сниму".
        *   Если Тип объявления = "Продам":
            *   `param Вид объекта` - `param_4869 Вид объекта`. Значения: "Гостиница", "Офисное помещение", ....
            *   `param Класс здания` - `param_4872 Класс здания`. Значения: "A", "B", "C", "D".
            *   ... (и другие параметры, см. источник)
        *   ... (параметры для "Сдам", "Куплю", "Сниму", см. источник)

*   **category_id=8, Недвижимость за рубежом**
    *   `param Тип объявления` - `param_4924 Тип объявления`. Значения: "Продам", "Сдам", "Куплю", "Сниму".
        *   Если Тип объявления = "Продам":
            *   `param Вид объекта` - `param_4926 Вид объекта`. Значения: "Квартира, апартаменты", "Дом, вилла", ....
            *   `param Страна` - `param_4932 Страна`. Значения: "Абхазия", "Австралия", "Австрия", ... (полный список стран, см. источник).
            *   ... (и другие параметры, см. источник)
        *   ... (параметры для "Сдам", "Куплю", "Сниму", см. источник)

*   **category_id=22, Автомобили**
    *   `param Тип автомобиля` - `param_7608 Тип автомобиля`. Значение: "С пробегом".
    *   `param Состояние` - `param_7610 Состояние`. Значения: "Не битый", "Битый".
    *   `param Владельцев по ПТС` - `param_12846 Владельцев по ПТС`. Значения: [любое целое число], "Новый".
    *   `param Марка` - `param_7614 Марка`. Значения: "AC", "Acura", "Alfa Romeo", "Alpina", "Aro", "Asia", "Aston Martin", "Audi", "BAW", "Bentley", "BMW", "Brilliance", "Bufori", "Bugatti", "Buick", "BYD", "Cadillac", "Caterham", "Changan", "ChangFeng", "Chery", "Chevrolet", "Chrysler", "Citroen", "Dacia", "Dadi", "Daewoo", "Daihatsu", "Daimler", "Datsun", "Derways", "Dodge", "Dongfeng", "Doninvest", "Eagle", "Ecomotors", "FAW", "Ferrari", "FIAT", "Ford", "Geely", "Geo", "GMC", "Gonow", "Great Wall", "Hafei", "Haima", "Haval", "Hawtai", "Honda", "Huanghai", "Hummer", "Hyundai", "Infiniti", "Iran Khodro", "Isuzu", "Iveco", "JAC", "Jaguar", "Jeep", "Jinbei", "JMC", "KIA", "Lamborghini", "Lancia", "Land Rover", "Landwind", "LDV", "Lexus", "LIFAN", "Lincoln", "Lotus", "Luxgen", "Mahindra", "Marussia", "Maserati", "Maybach", "Mazda", "Mercedes-Benz", "Mercury", "Metrocab", "MG", "MINI", "Mitsubishi", "Mitsuoka", "Morgan", "Morris", "Nissan", "Noble", "Oldsmobile", "Opel", "Pagani", "Peugeot", "Plymouth", "Pontiac", "Porsche", "Proton", "Ravon", "Renault", "Rolls-Royce", "Ronart", "Rover", "Saab", "Saleen", "Saturn", "Scion", "SEAT", "Shuanghuan", "Skoda", "SMA", "Smart", "Spyker", "SsangYong", "Subaru", "Suzuki", "Talbot", "Tata", "Tesla", "Tianma", "Tianye", "Toyota", "Trabant", "Volkswagen", "Volvo", "Vortex", "Wartburg", "Wiesmann", "Xin Kai", "ZOTYE", "ZX", "ВАЗ (LADA)", "ВИС", "ГАЗ", "ЗАЗ", "ЗИЛ", "ИЖ", "ЛуАЗ", "Москвич", "РАФ", "ТагАЗ", "УАЗ", "Другая", "Иномарки", "Отечественные", "Bajaj", "Foton", "Genesis", "Koenigsegg", "McLaren", "PUCH", "Westfield", "Zibar", "СМЗ".
    *   `param Модель` - `param_7616 Модель`. Значения зависят от выбранной марки автомобиля (см. полный список в источнике).
    *   `param Год выпуска, от`. Значения: [любое целое число], "до 1960".
    *   `param Год выпуска, до`. Значения: [любое целое число], "до 1960".
    *   `param Тип кузова` - `param_10365 Тип кузова`. Значения: "Седан", "Хетчбэк", "Универсал", "Внедорожник", "Кабриолет", "Кроссовер", "Купе", "Лимузин", "Минивэн", "Пикап", "Фургон", "Микроавтобус".
    *   `param Коробка передач` - `param_10378 Коробка передач`. Значения: "Механика", "Автомат", "Робот", "Вариатор".
    *   `param Тип двигателя` - `param_10383 Тип двигателя`. Значения: "Бензин", "Дизель", "Гибрид", "Электро", "Газ".
    *   `param Объём двигателя, л, от`. Значения: "0.0", "0.6", ..., [любое целое число].
    *   `param Объём двигателя, л, до`. Значения: "0.0", "0.6", ..., [любое целое число].
    *   `param Мощность двигателя, л.с., от`. Значения: [любое целое число].
    *   `param Мощность двигателя, л.с., до`. Значения: [любое целое число].
    *   `param Привод` - `param_10523 Привод`. Значения: "Передний", "Задний", "Полный".
    *   `param Руль` - `param_10527 Руль`. Значения: "Левый", "Правый".
    *   `param Цвет` - `param_10530 Цвет`. Значения: "Красный", "Коричневый", ..., "Серебряный".
    *   `param Пробег` - `param_12725 Пробег`.
    *   ... (и другие параметры, см. источник)

## Шаблон использования (пример на PHP)

API предназначено для периодического обращения, например, каждые 5 минут, с целью загрузки новых объявлений.
Пример скрипта на языке PHP, который получает объявления за последние 15 минут:

```php
<?php
//функция выполнения GET запросов через curl
function curlget($url){
    $ch = curl_init();
    curl_setopt ($ch, CURLOPT_URL, $url);
    curl_setopt_array($ch,array(
        CURLOPT_AUTOREFERER=>true,
        CURLOPT_FOLLOWLOCATION=>true,
        CURLOPT_HEADER=>false,
        CURLOPT_RETURNTRANSFER=>true,
        CURLOPT_VERBOSE=>false,
        CURLOPT_SSL_VERIFYPEER=>0,
        CURLOPT_ENCODING=>"", //!!!NEW
    ));
    $result = curl_exec($ch);
    curl_close($ch);
    return $result;
}

date_default_timezone_set('Europe/Moscow');

$login = 'user@localhost.net'; //здесь должен быть ваш логин в системе
$token = '12345'; //здесь должен быть ваш access_token

//задаем время получаемых объявлений, время отстает на 30 минут.
$date = new DateTime(); //текущее время
$date1 = clone $date; //копируем объект даты
$date1->sub(new DateInterval('PT46M')); //текущее минус 46 минут
$date2 = clone $date; //копируем объект даты
$date2->sub(new DateInterval('PT31M')); //текущее минус 31 минута
//таким образом интервал $date1 $date2 у нас будет 15 минут, теперь можно делать запрос

//формируем url запроса к API
$url = "https://ads-api.ru/main/api?user=".urlencode($login)."&token=".urlencode($token)
    ."&date1=".urlencode($date1->format('Y-m-d H:i:s'))
    ."&date2=".urlencode($date2->format('Y-m-d H:i:s'));

//делаем запрос к api
$str = file_get_contents($url);
//если предыдущий способ с file_get_contents не работает, то попробуйте через curl (для этого раскомментируйте следующую строку):
//$str = curlget($url);

//парсим ответ как json
$json = json_decode($str);

//проходим по всем объявлениям
foreach ($json->data as $adv) // $adv - объект объявления
{
    //выводим заголовок объявления
    echo '<br/>'.$adv->source.':'.$adv->title.':'.$adv->city;
}
?>
```
Этот скрипт можно настроить на запуск по крону (планировщику задач), чтобы получать новые объявления каждые 15 минут.

## Новости API (Последние изменения)

*   **08.04.2024**: Большинство объявлений от частников из раздела Недвижимость с Avito теперь идут без телефонов (поле `phone` содержит 11 нулей). Чтобы получать их через API, необходимо добавить параметр `withphone=0` в запрос. Это позволит получать все объявления, включая те без телефона. Если вы используете `person_type=3` вместе с `withphone=0`, рекомендуется использовать только `person_type=1`.
*   **06.02.2024**: Добавлен новый метод `/main/api-add-link-to-parse-queue` для добавления одного объявления в очередь на парсинг по ссылке.
*   **01.02.2024**: В метод `/main/api` добавлен параметр запроса `is_actual` и соответствующее поле в ответе. Теперь доступна фильтрация объявлений по актуальности.
*   **27.01.2024**: Добавлено описание параметра запроса `area` в метод `/main/api`. Фильтрация по координатам многоугольником стала документированной, хотя параметр существовал и ранее.
*   **08.01.2024**: Подтверждено, что при тестовом доступе значение поля `price` всегда равно 0.
*   **05.01.2024**: Теперь API принимает только разрешенные параметры, описанные в документации. Передача неизвестных параметров приводит к ошибке 400 с указанием некорректных имен в `params_with_error`.
*   **26.12.2023**: Исправлена ошибка в названии региона "Еврейская автономная область", ранее использовалось "Еврейская АО".
*   **27.06.2023**: Добавлена возможность фильтрации по полю `phone_protected`.
*   **25.06.2023**: Переход на новые тарифы.
*   **04.05.2023**: Анонсированы изменения цен и введение двух тарифов: 2000 р/мес (по купону, без телефонов) и 3000 р/мес (стандартный, с телефонами). Отмечено, что предоставляются те номера, что на источнике (часто подменные), и реальные номера взамен подменных не предоставляются. Многим пользователям номера не нужны, они работают только с объектами.
```