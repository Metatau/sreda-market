# –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: API –º–∞—Ä—à—Ä—É—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç HTML –≤–º–µ—Å—Ç–æ JSON

## üö® –ü–†–û–ë–õ–ï–ú–ê
API –º–∞—Ä—à—Ä—É—Ç `/api/auth/register` –∏ –¥—Ä—É–≥–∏–µ API endpoints –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç HTML-—Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–º–µ—Å—Ç–æ JSON-–æ—Ç–≤–µ—Ç–∞ –∏–∑-–∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ middleware –≤ Express.

## üéØ –¶–ï–õ–¨
–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ middleware —Ä–∞–∑ –∏ –Ω–∞–≤—Å–µ–≥–¥–∞, —á—Ç–æ–±—ã –í–°–ï API –º–∞—Ä—à—Ä—É—Ç—ã —Ä–∞–±–æ—Ç–∞–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

## üìã –î–ò–ê–ì–ù–û–°–¢–ò–ß–ï–°–ö–ò–ô –ü–õ–ê–ù

### –®–∞–≥ 1: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Å–µ—Ä–≤–µ—Ä–∞
```bash
# –ù–∞–π–¥–∏ –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª —Å–µ—Ä–≤–µ—Ä–∞ (–æ–±—ã—á–Ω–æ –æ–¥–∏–Ω –∏–∑ —ç—Ç–∏—Ö):
find . -name "server.js" -o -name "index.js" -o -name "app.js" -o -name "server.ts" -o -name "index.ts" | grep -E "(server|src)" | head -5
```

### –®–∞–≥ 2: –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞ middleware
–û—Ç–∫—Ä–æ–π –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª —Å–µ—Ä–≤–µ—Ä–∞ –∏ –Ω–∞–π–¥–∏ –ø–æ—Ä—è–¥–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
- –ì–¥–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è API routes?
- –ì–¥–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è Vite middleware?
- –ì–¥–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–µ—Ä–≤–µ—Ä?
- –ï—Å—Ç—å –ª–∏ catch-all routes (`app.get('*', ...)`)?

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤
–ù–∞–π–¥–∏ –í–°–ï —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å routes:
```bash
find . -name "*.ts" -o -name "*.js" | xargs grep -l "app.use\|app.get\|router.use" | grep -v node_modules
```

## üîß –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –ü—Ä–∞–≤–∏–ª–æ 1: API routes –í–°–ï–ì–î–ê –ü–ï–†–í–´–ï
```javascript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–´–ô –ü–û–†–Ø–î–û–ö:
// 1. –°–Ω–∞—á–∞–ª–∞ middleware –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
app.use(express.json());
app.use(express.urlencoded({ extended: true }));
app.use(cors());

// 2. –ó–ê–¢–ï–ú –≤—Å–µ API routes
app.use('/api/auth', authRoutes);
app.use('/api/properties', propertiesRoutes);
app.use('/api', allOtherApiRoutes);

// 3. –¢–û–õ–¨–ö–û –ü–û–¢–û–ú Vite/—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
if (isDevelopment) {
  app.use(vite.middlewares);
} else {
  app.use(express.static('dist'));
}

// 4. –í –°–ê–ú–û–ú –ö–û–ù–¶–ï catch-all –¥–ª—è SPA
app.get('*', (req, res) => {
  // SPA fallback
});
```

### –ü—Ä–∞–≤–∏–ª–æ 2: –ó–∞—â–∏—Ç–∞ API –æ—Ç catch-all
```javascript
// –ï—Å–ª–∏ catch-all –Ω–µ–∏–∑–±–µ–∂–µ–Ω, –¥–æ–±–∞–≤—å –ø—Ä–æ–≤–µ—Ä–∫—É:
app.get('*', (req, res, next) => {
  // –ù–ï –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å API routes
  if (req.path.startsWith('/api')) {
    return next();
  }
  // –û—Ç–¥–∞–≤–∞—Ç—å HTML —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ-API routes
  res.sendFile(path.join(__dirname, 'dist/index.html'));
});
```

### –ü—Ä–∞–≤–∏–ª–æ 3: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Vite
–í `vite.config.js` –Ω–∞—Å—Ç—Ä–æ–π proxy:
```javascript
export default defineConfig({
  server: {
    proxy: {
      '/api': {
        target: 'http://localhost:3000', // –ø–æ—Ä—Ç API —Å–µ—Ä–≤–µ—Ä–∞
        changeOrigin: true,
        secure: false
      }
    }
  }
});
```

## üß™ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û–ï –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –¢–µ—Å—Ç 1: –ü—Ä—è–º–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ API
```bash
curl -X POST "http://localhost:3000/api/auth/register" \
  -H "Content-Type: application/json" \
  -d '{"email":"test@test.com","password":"test123"}' \
  -v
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- Status: 200, 201, 400, –∏–ª–∏ 422 (–ù–ï 404)
- Content-Type: application/json (–ù–ï text/html)
- Response: JSON –æ–±—ä–µ–∫—Ç (–ù–ï HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞)

### –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö API endpoints
```bash
# –ù–∞–π–¥–∏ –≤—Å–µ API routes –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –∫–∞–∂–¥—ã–π:
curl -s "http://localhost:3000/api/auth/login" -I
curl -s "http://localhost:3000/api/properties" -I
curl -s "http://localhost:3000/api/users" -I
```

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ Network –≤–∫–ª–∞–¥–∫–∏
1. –û—Ç–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä Developer Tools
2. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ Network –≤–∫–ª–∞–¥–∫—É
3. –°–¥–µ–ª–∞–π API –∑–∞–ø—Ä–æ—Å –∏–∑ frontend
4. –£–±–µ–¥–∏—Å—å —á—Ç–æ:
   - Request URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
   - Response Type: xhr/fetch (–ù–ï document)
   - Content-Type: application/json

## üö´ –ß–¢–û –ù–ï –î–ï–õ–ê–¢–¨

### ‚ùå –ó–ê–ü–†–ï–©–ï–ù–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø:
1. **–ù–ï** –º–µ–Ω—è–π –ª–æ–≥–∏–∫—É API –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤, –µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ middleware
2. **–ù–ï** –¥–æ–±–∞–≤–ª—è–π –Ω–æ–≤—ã–µ routes, –Ω–µ –∏—Å–ø—Ä–∞–≤–∏–≤ –ø–æ—Ä—è–¥–æ–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö
3. **–ù–ï** –∏—Å–ø–æ–ª—å–∑—É–π –æ–±—Ö–æ–¥–Ω—ã–µ –ø—É—Ç–∏ —Ç–∏–ø–∞ `res.json()` –µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ routing
4. **–ù–ï** —Ç—Ä–æ–≥–∞–π Vite –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é, –ø–æ–∫–∞ –Ω–µ –∏—Å–ø—Ä–∞–≤–∏—à—å Express middleware

### ‚ùå –ß–ê–°–¢–´–ï –û–®–ò–ë–ö–ò:
```javascript
// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - Vite –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ:
app.use(vite.middlewares);
app.use('/api', routes); // ‚Üê –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è

// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - catch-all —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ:
app.get('*', sendIndexHtml);
app.use('/api', routes); // ‚Üê –Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º–æ

// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - —Å—Ç–∞—Ç–∏–∫–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç API:
app.use(express.static('public'));
app.use('/api', routes); // ‚Üê –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å
```

## üìù –ü–û–®–ê–ì–û–í–´–ô –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

1. **–ù–∞–π–¥–∏ –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª —Å–µ—Ä–≤–µ—Ä–∞** (server.js, index.js, app.js)
2. **–û–ø—Ä–µ–¥–µ–ª–∏ —Ç–µ–∫—É—â–∏–π –ø–æ—Ä—è–¥–æ–∫ middleware** - –≤—ã–ø–∏—à–∏ —Å–ø–∏—Å–æ–∫
3. **–ù–∞–π–¥–∏ –í–°–ï —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ routes** –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö
4. **–ü–µ—Ä–µ—Å—Ç–∞–≤—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:**
   - –ü–∞—Ä—Å–∏–Ω–≥ middleware
   - API routes
   - Vite/—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
   - SPA fallback
5. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –ö–ê–ñ–î–´–ô API endpoint** curl –∫–æ–º–∞–Ω–¥–∞–º–∏
6. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ** —á–µ—Ä–µ–∑ Network –≤–∫–ª–∞–¥–∫—É
7. **–£–±–µ–¥–∏—Å—å —á—Ç–æ frontend –≤—Å–µ –µ—â–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**

## ‚úÖ –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê

### –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
- [ ] `curl -X POST /api/auth/register` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON
- [ ] –í—Å–µ API endpoints –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Content-Type
- [ ] Frontend API –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- [ ] SPA routing –≤—Å–µ –µ—â–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- [ ] Hot reload —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ development —Ä–µ–∂–∏–º–µ

### –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
```bash
# –≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –î–û–õ–ñ–ï–ù –≤–µ—Ä–Ω—É—Ç—å JSON, –∞ –ù–ï HTML:
curl -s "http://localhost:3000/api/auth/register" | head -1
# –ï—Å–ª–∏ –≤–∏–¥–∏—à—å "<!DOCTYPE html>" - middleware –ø–æ—Ä—è–¥–æ–∫ –≤—Å–µ –µ—â–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
# –ï—Å–ª–∏ –≤–∏–¥–∏—à—å "{" –∏–ª–∏ error JSON - –ø—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞
```

## üîÑ –ï–°–õ–ò –ü–†–û–ë–õ–ï–ú–ê –ü–û–í–¢–û–†–Ø–ï–¢–°–Ø

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. –ü—Ä–æ–≤–µ—Ä—å, –Ω–µ—Ç –ª–∏ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç middleware
2. –£–±–µ–¥–∏—Å—å, —á—Ç–æ –Ω–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö route —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π
3. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ package.json scripts –∑–∞–ø—É—Å–∫–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–∞–π–ª
4. –ò—â–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –º–µ–∂–¥—É development –∏ production –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏

**–ü–û–ú–ù–ò:** Middleware –ø–æ—Ä—è–¥–æ–∫ –≤ Express –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω. –¢–æ, —á—Ç–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –ø–µ—Ä–≤—ã–º - –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º!