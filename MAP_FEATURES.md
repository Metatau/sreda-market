# Функциональность карты SREDA Market

## Реализованные возможности

### 1. Кластеризация объектов
- **Автоматическое группирование**: Объекты автоматически группируются в кластеры при большом количестве
- **Цветовая индикация плотности**:
  - Синий (#51bbd6): До 100 объектов
  - Желтый (#f1f075): 100-750 объектов 
  - Розовый (#f28cb1): Более 750 объектов
- **Интерактивность**: Клик по кластеру увеличивает масштаб для детального просмотра

### 2. Тепловые карты
- **Режим "Плотность"**: Показывает концентрацию объектов недвижимости
- **Режим "Цены"**: Визуализирует ценовые зоны с градиентной окраской
- **Режим "Инвестиции"**: Отображает инвестиционную привлекательность районов
- **Настройка интенсивности**: Слайдер для регулировки яркости тепловой карты

### 3. Fallback-интерфейс
- **Graceful degradation**: При отсутствии Mapbox токена показывается альтернативный интерфейс
- **Список объектов**: Отображение найденных объектов в виде карточек
- **Информативные сообщения**: Понятные уведомления о необходимости настройки API

### 4. Поиск адресов
- **Геокодирование**: Поиск координат по адресу с использованием Mapbox Geocoding API
- **Автодополнение**: Умные предложения адресов при вводе
- **Фокусировка**: Автоматический переход к найденному адресу на карте
- **Российские адреса**: Оптимизация для поиска по территории России

### 5. Интерактивные элементы
- **Выбор объектов**: Клик по отдельному объекту открывает детальную информацию
- **Карточки объектов**: Всплывающие окна с основными характеристиками
- **Переключение режимов**: Кнопки для смены отображения карты
- **Навигация**: Плавные переходы и анимации при изменении масштаба

## Технические особенности

### CDN интеграция
- Использование Mapbox GL JS v3.12.0 через CDN
- Отсутствие зависимостей в package.json
- Быстрая загрузка и стабильная работа

### Адаптивность
- Корректное отображение на различных устройствах
- Оптимизированные элементы управления
- Масштабируемые маркеры и кластеры

### Производительность
- Эффективная обработка больших массивов данных
- Оптимизированная кластеризация
- Плавные анимации переходов

## Требования

### Обязательные
- Действующий токен Mapbox (VITE_MAPBOX_ACCESS_TOKEN)
- Браузер с поддержкой WebGL

### Рекомендуемые
- Стабильное интернет-соединение
- Современный браузер (Chrome 80+, Firefox 74+, Safari 13+)

## Конфигурация

Для полной функциональности карты необходимо:
1. Получить токен на https://account.mapbox.com/access-tokens/
2. Добавить токен в переменные окружения как VITE_MAPBOX_ACCESS_TOKEN
3. Перезапустить приложение

## Векторные тайлы (Advanced)

### Преимущества
- **Высокая производительность**: Обработка миллионов объектов без задержек
- **Масштабируемость**: Автоматическая оптимизация для разных масштабов
- **Кэширование**: Векторные тайлы кэшируются браузером
- **Меньший трафик**: Загружаются только видимые области

### Создание тайлов
```bash
# Экспорт данных из PostgreSQL
./scripts/export-geojson.sh

# Создание векторных тайлов
./scripts/create-tiles.sh
```

### Использование
- Автоматическое переключение на векторные тайлы при наличии
- Поддержка кластеризации на уровне тайлов
- Оптимизированные тепловые карты
- Интеграция с Mapbox Studio для облачного хостинга
- Глобальная CDN для быстрой загрузки

## Поддерживаемые форматы данных

- Координаты в формате "широта,долгота"
- Цены в рублях (для тепловых карт)
- Инвестиционные рейтинги (числовые значения)
- Векторные тайлы (.mbtiles)
- GeoJSON экспорт